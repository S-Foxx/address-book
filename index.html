<!doctype html>
<html lang="en" ng-app="abApp">
<head>
  <meta charset="utf-8">
  <title>Address Book</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap (CDN) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.2/css/bootstrap.min.css"/>

  <!-- AngularJS 1.8.2 (CDN) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.2/angular.min.js"></script>
  <link rel="manifest" href="manifest.webmanifest">
  <script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js');
  }
  </script>
  <style>
    /* intentionally plain */
    body { padding: 12px; }
    .toolbar { margin-bottom: 12px; }
    .cardish {
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 10px;
      margin-bottom: 10px;
    }
    .cardish h6 { margin: 0 0 6px 0; font-weight: 600; }
    .muted { color: #666; font-size: 0.9rem; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(220px,1fr)); grid-gap: 10px; }
    .tiny { font-size: 0.85rem; }
    .pill { display:inline-block; padding:2px 6px; border:1px solid #ddd; border-radius: 10px; }
  </style>
</head>
<body ng-controller="MainCtrl as vm">

  <div class="toolbar">
    <div class="form-row align-items-center">
      <div class="col-sm-4 mb-2">
        <input class="form-control" type="text" placeholder="Search (name, company, city, email, phone)"
               ng-model="vm.searchText">
      </div>

      <div class="col-sm-3 mb-2">
        <select class="form-control" ng-model="vm.countryFilter" ng-options="c for c in vm.countries">
          <option value="" aria-placeholder="Filter by country (all)">Filter by country (all)</option>
        </select>
      </div>

      <div class="col-sm-5 mb-2 text-sm-right">
        <div class="btn-group btn-group-sm" role="group">
          <button class="btn btn-outline-secondary" ng-class="{'active': vm.view==='table'}"
                  ng-click="vm.view='table'">Table</button>
          <button class="btn btn-outline-secondary" ng-class="{'active': vm.view==='cards'}"
                  ng-click="vm.view='cards'">Business Cards</button>
        </div>
        <span class="ml-2 tiny muted" ng-if="vm.contacts.length">Showing {{ (vm.filtered = (vm.contacts | filter:vm.predicate)).length }} / {{ vm.contacts.length }}</span>
      </div>
    </div>
  </div>

  <!-- Table View -->
  <div ng-show="vm.view==='table'">
    <div class="table-responsive">
      <table class="table table-sm table-bordered">
        <thead class="thead-light">
          <tr>
            <th>Company</th>
            <th>Contact</th>
            <th>Title</th>
            <th>City</th>
            <th>Country</th>
            <th>Email</th>
            <th>Phone</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="c in (vm.contacts | filter:vm.predicate) track by $index">
            <td>{{c.CompanyName}}</td>
            <td>{{c.ContactName}}</td>
            <td>{{c.ContactTitle}}</td>
            <td>{{c.City}}</td>
            <td>{{c.Country}}</td>
            <td><a ng-href="mailto:{{c.Email}}">{{c.Email}}</a></td>
            <td>{{c.Phone}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Business Card View -->
  <div ng-show="vm.view==='cards'">
    <div class="grid">
      <div class="cardish" ng-repeat="c in (vm.contacts | filter:vm.predicate) track by $index">
        <h6>{{c.ContactName}} <span class="pill tiny">{{c.ContactTitle}}</span></h6>
        <div class="muted">{{c.CompanyName}}</div>
        <div class="tiny mt-2">
          <div>{{c.Address}}</div>
          <div>{{c.City}} <span ng-if="c.Region">({{c.Region}})</span> {{c.PostalCode}}</div>
          <div>{{c.Country}}</div>
        </div>
        <hr/>
        <div class="tiny">
          <div>Email: <a ng-href="mailto:{{c.Email}}">{{c.Email}}</a></div>
          <div>Phone: {{c.Phone}} <span ng-if="c.Fax" class="muted"> | Fax: {{c.Fax}}</span></div>
        </div>
      </div>
    </div>
  </div>

  <div class="alert alert-warning tiny mt-3" ng-if="vm.error">
    {{vm.error}}
  </div>

  <script src="app.js"></script>
</body>
</html>
